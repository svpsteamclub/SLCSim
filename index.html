<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Robot Seguidor de Líneas Arduino</title>
    <link rel="stylesheet" href="style.css">
    <!-- Opcional: CodeMirror para el editor de código -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/theme/material-darker.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Simulador Robot Seguidor de Líneas (Arduino)</h1>
        </header>

        <main class="main-layout">
            <section id="simulation-area" class="panel">
                <h2>Simulación</h2>
                <canvas id="simulationCanvas" width="600" height="400"></canvas>
                <div class="simulation-controls">
                    <button id="btnStart">Iniciar</button>
                    <button id="btnPause">Pausar</button>
                    <button id="btnReset">Reiniciar</button>
                    <label for="simSpeed">Velocidad:</label>
                    <input type="range" id="simSpeed" min="1" max="10" value="5">
                </div>
            </section>

            <aside class="sidebar">
                <section id="robot-editor" class="panel">
                    <h2>Editor de Robot</h2>
                    <div>
                        <label for="numSensors">Nº Sensores:</label>
                        <input type="number" id="numSensors" value="5" min="1" max="8">
                    </div>
                    <div>
                        <label for="sensorSpacing">Espaciado (px):</label>
                        <input type="number" id="sensorSpacing" value="10" min="1" max="30">
                    </div>
                    <div>
                        <label for="robotSpeed">Velocidad Base (px/tick):</label>
                        <input type="number" id="robotSpeed" value="2" min="0.1" max="5" step="0.1">
                    </div>
                    <!-- Más parámetros del robot (ej. ancho, color) -->
                </section>

                <section id="track-editor" class="panel">
                    <h2>Editor de Pista</h2>
                    <canvas id="trackEditorCanvas" width="300" height="200"></canvas>
                    <div class="track-tools">
                        <button id="btnDrawLine">Dibujar Línea</button>
                        <button id="btnClearTrack">Limpiar Pista</button>
                        <label for="lineColor">Color Línea:</label>
                        <input type="color" id="lineColor" value="#000000">
                        <label for="trackBgColor">Color Fondo:</label>
                        <input type="color" id="trackBgColor" value="#FFFFFF">
                    </div>
                </section>

                <section id="code-editor" class="panel">
                    <h2>Editor de Código (Arduino)</h2>
                    <textarea id="arduinoCode">
// Variables globales (si las necesitas)
// int Kp = 10;

void setup() {
  // Configuración inicial del robot
  // Por ejemplo, definir pines de sensores/motores (simulado)
  // pinMode(sensorIzquierdoPin, INPUT);
  // pinMode(motorDerechoPin, OUTPUT);
  Serial.begin(9600); // Simular Serial Monitor
  Serial.println("Robot Iniciado");
}

void loop() {
  // Lee los sensores (simulado)
  // int sensorIzquierdo = digitalRead(0); // sensor 0
  // int sensorCentro = digitalRead(1);   // sensor 1
  // int sensorDerecho = digitalRead(2);  // sensor 2

  // Lógica de control para seguir la línea
  // if (sensorCentro == 1) {
  //   // Avanzar
  //   motorIzquierdo(100);
  //   motorDerecho(100);
  // } else if (sensorIzquierdo == 1) {
  //   // Girar a la izquierda
  //   motorIzquierdo(50);
  //   motorDerecho(150);
  // } else if (sensorDerecho == 1) {
  //   // Girar a la derecha
  //   motorIzquierdo(150);
  //   motorDerecho(50);
  // } else {
  //   // Parar o buscar línea
  //   motorIzquierdo(0);
  //   motorDerecho(0);
  // }

  // Espera un poco para la siguiente iteración (simulado)
  delay(20);
}
                    </textarea>
                    <button id="btnUploadCode">Cargar Código al Robot</button>
                    <div id="serialMonitorOutput" class="serial-monitor">
                        <p><strong>Serial Monitor:</strong></p>
                        <pre></pre>
                    </div>
                </section>
            </aside>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/mode/clike/clike.min.js"></script>
    <script src="js/robot.js"></script>
    <script src="js/track.js"></script>
    <script src="js/arduinoInterpreter.js"></script>
    <script src="js/simulation.js"></script>
    <script src="js/main.js"></script>
</body>
</html>